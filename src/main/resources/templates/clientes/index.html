<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clientes - JurisCRM</title>

    <meta name="_csrf" th:content="${_csrf.token}" />
    <meta name="_csrf_header" th:content="${_csrf.headerName}" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/tailwind.css}">

    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
</head>

<body>

    <div th:replace="~{fragments/sidebar :: sidebar(activePage='clientes')}"></div>

    <main class="main-content" id="clientes-modulo" style="margin-left: 280px; margin: 0 auto 0 280px;">
        <div class="page-header">
            <div>
                <h1 class="page-title">Clientes</h1>
                <p class="page-subtitle">Cadastro e gestão de clientes do CRM</p>
            </div>
            <div class="d-flex gap-2">
                <button type="button" onclick="openImportClientesModal()" class="btn btn-outline-secondary btn-sm" sec:authorize="hasAuthority('CLIENTES_CREATE')">
                    <i class="fas fa-file-upload me-1"></i>
                    Importar
                </button>
                <button type="button" onclick="openClienteModal()" class="btn-new-process" sec:authorize="hasAuthority('CLIENTES_CREATE')">
                    <i class="fas fa-plus"></i>
                    Novo Cliente
                </button>
            </div>
        </div>

        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" name="query" class="search-input"
                placeholder="Buscar por nome, CPF/CNPJ, e-mail ou telefone..."
                hx-get="/clientes/search"
                hx-trigger="keyup changed delay:400ms"
                hx-target="#client-list"
                hx-swap="outerHTML">
        </div>

        <div id="client-list" th:fragment="list">
            <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                <div class="table-responsive">
                    <table class="table table-sm align-middle mb-0">
                        <thead>
                            <tr class="text-uppercase small text-muted">
                                <th class="text-center">Cliente</th>
                                <th>CPF/CNPJ</th>
                                <th>E-mail</th>
                                <th>Telefone</th>
                                <th class="text-end">Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:if="${#lists.isEmpty(clientes)}">
                                <td colspan="5" class="text-center text-muted py-4">Nenhum cliente cadastrado.</td>
                            </tr>
                            <tr th:each="c : ${clientes}">
                                <td class="fw-semibold text-center" th:text="${c.nome}">Nome</td>
                                <td class="small cpfcnpj-cell" th:text="${c.cpfCnpj}">000</td>
                                <td class="small" th:text="${c.email}">email</td>
                                <td class="small">
                                    <div class="d-flex align-items-center gap-2">
                                        <span class="phone-cell" th:text="${c.telefone}">telefone</span>
                                        <a th:if="${c.telefone != null and !c.telefone.isEmpty()}"
                                            th:href="'whatsapp://send?phone=55' + ${c.telefone.replaceAll('\D', '')}"
                                            target="_blank" class="text-success hover:text-green-700 transition-colors"
                                            title="Conversar no WhatsApp Desktop">
                                            <i class="fab fa-whatsapp text-lg"></i>
                                        </a>
                                    </div>
                                </td>
                                <td class="text-end">
                    <button type="button" class="btn btn-sm btn-outline-primary" sec:authorize="hasAuthority('CLIENTES_EDIT')"
                                        th:attr="data-id=${c.id},data-nome=${c.nome},data-cpfcnpj=${c.cpfCnpj},data-email=${c.email},data-telefone=${c.telefone},data-indicacao=${c.indicacao},data-cep=${c.cep},data-logradouro=${c.logradouro},data-numero=${c.numero},data-complemento=${c.complemento},data-bairro=${c.bairro},data-cidade=${c.cidade},data-uf=${c.uf}"
                                        onclick="openClienteModalFromRow(this)">
                                        <i class="fas fa-pen"></i>
                                    </button>
                                    <a class="btn btn-sm btn-outline-secondary"
                                        th:href="@{'/processos'(clienteId=${c.id})}" title="Ver processos do cliente">
                                        <i class="fas fa-folder-open"></i>
                                    </a>
                                    <button type="button" class="btn btn-sm btn-outline-danger" sec:authorize="hasAuthority('CLIENTES_DELETE')"
                                        th:attr="data-id=${c.id},data-nome=${c.nome}"
                                        onclick="confirmDeleteClienteFromRow(this)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div class="d-flex align-items-center justify-content-between border-top p-3">
                    <div class="small text-muted">
                        Mostrando <span th:text="${fromItem}">0</span>–<span th:text="${toItem}">0</span> de <span
                            th:text="${totalElements}">0</span>
                    </div>
                    <div class="btn-group" role="group" aria-label="Paginação">
                        <a class="btn btn-outline-secondary btn-sm" th:classappend="${clientesPage.first} ? ' disabled'"
                            th:href="@{'/clientes'(page=${currentPage - 1}, size=${pageSize})}">
                            Anterior
                        </a>
                        <a class="btn btn-outline-secondary btn-sm" th:classappend="${clientesPage.last} ? ' disabled'"
                            th:href="@{'/clientes'(page=${currentPage + 1}, size=${pageSize})}">
                            Próximo
                        </a>
                    </div>
                    <div class="d-flex align-items-center">
                        <label class="small text-muted me-2">Itens por página</label>
                        <select class="form-select form-select-sm" th:value="${pageSize}"
                            onchange="location.href='/clientes?size=' + this.value">
                            <option value="10" th:selected="${pageSize == 10}">10</option>
                            <option value="20" th:selected="${pageSize == 20}">20</option>
                            <option value="50" th:selected="${pageSize == 50}">50</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        function openImportClientesModal() {
            var html = '' +
                '<div class="mb-2 text-start">' +
                ' <p class="small text-muted mb-1">Arquivos aceitos: CSV, XLSX, XLS (máx. 10MB)</p>' +
                '</div>' +
                '<div id="dz" style="border: 2px dashed #ccc; border-radius: 8px; padding: 24px; text-align: center;">' +
                ' <i class="fas fa-cloud-upload-alt fa-2x text-secondary mb-2"></i>' +
                ' <div class="mb-2">Arraste e solte aqui</div>' +
                ' <div class="small text-muted mb-2">ou</div>' +
                ' <button type="button" id="btn-file" class="btn btn-sm btn-outline-secondary">Escolher arquivo</button>' +
                ' <input type="file" id="file-input" style="display:none" accept=".csv,.xlsx,.xls" />' +
                '</div>' +
                '<div id="dz-status" class="text-start mt-3 small"></div>';

            Swal.fire({
                title: 'Importar Clientes',
                html: html,
                showCancelButton: true,
                confirmButtonText: 'Enviar',
                cancelButtonText: 'Fechar',
                preConfirm: function () {
                    var container = Swal.getHtmlContainer();
                    var input = container.querySelector('#file-input');
                    if (!input || !input.files || input.files.length === 0) {
                        Swal.showValidationMessage('Selecione um arquivo.');
                        return false;
                    }
                    var f = input.files[0];
                    if (f.size > 10 * 1024 * 1024) {
                        Swal.showValidationMessage('Arquivo maior que 10MB.');
                        return false;
                    }
                    var fd = new FormData();
                    fd.append('file', f);
                    var csrfTokenMeta = document.querySelector('meta[name=\"_csrf\"]');
                    var csrfHeaderMeta = document.querySelector('meta[name=\"_csrf_header\"]');
                    var csrfToken = csrfTokenMeta ? csrfTokenMeta.getAttribute('content') : null;
                    var csrfHeader = csrfHeaderMeta ? csrfHeaderMeta.getAttribute('content') : null;
                    var headers = { 'X-Requested-With': 'XMLHttpRequest' };
                    if (csrfToken && csrfHeader) { headers[csrfHeader] = csrfToken; }
                    return fetch('/clientes/import', { method: 'POST', body: fd, headers: headers, credentials: 'same-origin' })
                        .then(function (r) { return r.json().then(function (j) { return { ok: r.ok, body: j }; }); })
                        .then(function (res) {
                            if (!res.ok) {
                                var msg = (res.body && res.body.errors && res.body.errors[0]) ? res.body.errors[0] : 'Falha ao importar.';
                                Swal.showValidationMessage(msg);
                                return false;
                            }
                            return res.body;
                        })
                        .catch(function () {
                            Swal.showValidationMessage('Falha ao enviar arquivo.');
                            return false;
                        });
                }
            }).then(function (r) {
                if (r.isConfirmed && r.value) {
                    var b = r.value;
                    var msg = 'Criados: ' + (b.createdCount || 0) + ', Ignorados: ' + (b.skippedCount || 0) + ', Erros: ' + (b.errorCount || 0);
                    uiToastSuccess('Importação concluída. ' + msg);
                    if (b.errors && b.errors.length) {
                        var totalErros = b.errors.length;
                        var relatorio = 'Erros (limitado ao retorno):\n' + b.errors.join('\n');
                        Swal.fire({
                            icon: 'info',
                            title: 'Importação com avisos',
                            text: 'Foram identificados ' + totalErros + ' avisos de dados. Você pode baixar um relatório para análise.',
                            showCancelButton: true,
                            confirmButtonText: 'Baixar relatório',
                            cancelButtonText: 'Fechar'
                        }).then(function (res) {
                            if (res.isConfirmed) {
                                try {
                                    var blob = new Blob([relatorio], { type: 'text/plain;charset=utf-8' });
                                    var url = URL.createObjectURL(blob);
                                    var a = document.createElement('a');
                                    a.href = url;
                                    a.download = 'erros-importacao-clientes.txt';
                                    document.body.appendChild(a);
                                    a.click();
                                    URL.revokeObjectURL(url);
                                    a.remove();
                                } catch (e) {
                                    // fallback: mostrar pequena prévia de 5 linhas
                                    var preview = b.errors.slice(0, 5).join('\\n');
                                    Swal.fire({ icon: 'info', title: 'Prévia de avisos', html: '<pre style=\"white-space: pre-wrap; text-align:left;\">' + preview + '</pre>' });
                                }
                            }
                        });
                    }
                    refreshClientesList();
                }
            });

            setTimeout(function () {
                var container = Swal.getHtmlContainer();
                var dz = container.querySelector('#dz');
                var input = container.querySelector('#file-input');
                var btnFile = container.querySelector('#btn-file');
                var status = container.querySelector('#dz-status');
                function preventDefaults(e) {
                    e.preventDefault();
                    e.stopPropagation();
                }
                ['dragenter','dragover','dragleave','drop'].forEach(function (ev) { dz.addEventListener(ev, preventDefaults, false); });
                dz.addEventListener('dragover', function () { dz.style.borderColor = '#0d6efd'; }, false);
                dz.addEventListener('dragleave', function () { dz.style.borderColor = '#ccc'; }, false);
                dz.addEventListener('drop', function (e) {
                    var dt = e.dataTransfer;
                    var files = dt.files;
                    if (files && files[0]) {
                        input.files = files;
                        dz.style.borderColor = '#198754';
                        status.textContent = 'Selecionado: ' + files[0].name + ' (' + Math.round(files[0].size/1024) + ' KB)';
                    }
                }, false);
                btnFile.addEventListener('click', function(){ input.click(); });
                input.addEventListener('change', function(){
                    var f = input.files && input.files[0];
                    if (f) {
                        dz.style.borderColor = '#198754';
                        status.textContent = 'Selecionado: ' + f.name + ' (' + Math.round(f.size/1024) + ' KB)';
                    }
                });
            }, 50);
        }

        function refreshClientesList() {
            var input = document.querySelector('input[name="query"]');
            var q = input ? (input.value || '') : '';
            htmx.ajax('GET', '/clientes/search?query=' + encodeURIComponent(q), { target: '#client-list', swap: 'outerHTML' });
        }

        function clienteFormHtml(values) {
            var v = values || {};
            return '' +
                '<form id="cliente-form" class="text-start">' +
                '  <div class="mb-3">' +
                '    <label class="form-label">Nome</label>' +
                '    <input name="nome" class="form-control" value="' + (v.nome || '') + '">' +
                '  </div>' +
                '  <div class="mb-3">' +
                '    <label class="form-label">CPF/CNPJ</label>' +
                '    <input name="cpfCnpj" class="form-control" value="' + (v.cpfCnpj || '') + '">' +
                '  </div>' +
                '  <div class="mb-3">' +
                '    <label class="form-label">E-mail</label>' +
                '    <input name="email" type="email" class="form-control" value="' + (v.email || '') + '">' +
                '  </div>' +
                '  <div class="mb-3">' +
                '    <label class="form-label">Telefone</label>' +
                '    <input name="telefone" class="form-control" value="' + (v.telefone || '') + '">' +
                '  </div>' +
                '  <div class="row g-2 mb-2">' +
                '    <div class="col-8">' +
                '      <label class="form-label">CEP</label>' +
                '      <input name="cep" class="form-control" placeholder="Somente números" value="' + (v.cep || '') + '">' +
                '    </div>' +
                '    <div class="col-4 d-flex align-items-end">' +
                '      <button type="button" class="btn btn-outline-secondary w-100" id="btn-buscar-cep"><i class="fas fa-search me-1"></i>Buscar CEP</button>' +
                '    </div>' +
                '  </div>' +
                '  <div class="mb-2">' +
                '    <label class="form-label">Logradouro</label>' +
                '    <input name="logradouro" class="form-control" value="' + (v.logradouro || '') + '">' +
                '  </div>' +
                '  <div class="row g-2 mb-2">' +
                '    <div class="col-4">' +
                '      <label class="form-label">Número</label>' +
                '      <input name="numero" class="form-control" value="' + (v.numero || '') + '">' +
                '    </div>' +
                '    <div class="col-8">' +
                '      <label class="form-label">Complemento</label>' +
                '      <input name="complemento" class="form-control" value="' + (v.complemento || '') + '">' +
                '    </div>' +
                '  </div>' +
                '  <div class="row g-2 mb-3">' +
                '    <div class="col-6">' +
                '      <label class="form-label">Bairro</label>' +
                '      <input name="bairro" class="form-control" value="' + (v.bairro || '') + '">' +
                '    </div>' +
                '    <div class="col-4">' +
                '      <label class="form-label">Cidade</label>' +
                '      <input name="cidade" class="form-control" value="' + (v.cidade || '') + '">' +
                '    </div>' +
                '    <div class="col-2">' +
                '      <label class="form-label">UF</label>' +
                '      <input name="uf" class="form-control" maxlength="2" value="' + (v.uf || '') + '">' +
                '    </div>' +
                '  </div>' +
                '  <div class="mb-0">' +
                '    <label class="form-label">Indicação</label>' +
                '    <input name="indicacao" class="form-control" value="' + (v.indicacao || '') + '">' +
                '  </div>' +
                '</form>';
        }

        function openClienteModal() {
            openClienteModalInternal(null);
        }

        function openClienteModalFromRow(button) {
            var d = button ? button.dataset : {};
            openClienteModalInternal({
                id: d.id,
                nome: d.nome,
                cpfCnpj: d.cpfcnpj,
                email: d.email,
                telefone: d.telefone,
                indicacao: d.indicacao,
                cep: d.cep,
                logradouro: d.logradouro,
                numero: d.numero,
                complemento: d.complemento,
                bairro: d.bairro,
                cidade: d.cidade,
                uf: d.uf
            });
        }

        function openClienteModalInternal(data) {
            var isEdit = data && data.id;
            var title = isEdit ? 'Editar Cliente' : 'Novo Cliente';
            var url = isEdit ? ('/clientes/' + data.id) : '/clientes';

            Swal.fire({
                title: title,
                html: clienteFormHtml(data),
                showCancelButton: true,
                confirmButtonText: 'Salvar',
                cancelButtonText: 'Cancelar',
                focusConfirm: false,
                didOpen: function (dom) {
                    var input = dom.querySelector('input[name="cpfCnpj"]');
                    if (input && window.uiMaskCpfCnpjInput && window.uiFormatCpfCnpj) {
                        // Formatar valor inicial e aplicar máscara
                        try { input.value = window.uiFormatCpfCnpj(input.value); } catch (e) { }
                        window.uiMaskCpfCnpjInput(input);
                    }
                    var phone = dom.querySelector('input[name="telefone"]');
                    if (phone && window.uiMaskPhoneInput && window.uiFormatPhoneBR) {
                        try { phone.value = window.uiFormatPhoneBR(phone.value); } catch (e) { }
                        window.uiMaskPhoneInput(phone);
                    }
                    var cepInput = dom.querySelector('input[name="cep"]');
                    var btnBuscar = dom.querySelector('#btn-buscar-cep');
                    function cleanDigits(s){ return (s || '').replace(/\D+/g,''); }
                    function fillAddress(d){
                        var log = dom.querySelector('input[name="logradouro"]');
                        var bai = dom.querySelector('input[name="bairro"]');
                        var cid = dom.querySelector('input[name="cidade"]');
                        var uf = dom.querySelector('input[name="uf"]');
                        if (log && d.logradouro) log.value = d.logradouro;
                        if (bai && d.bairro) bai.value = d.bairro;
                        if (cid && d.localidade) cid.value = d.localidade;
                        if (uf && d.uf) uf.value = d.uf;
                    }
                    function buscarCEP() {
                        var raw = cepInput ? cepInput.value : '';
                        var cep = cleanDigits(raw);
                        if (!cep || cep.length !== 8) {
                            if (window.Swal && Swal.showValidationMessage) {
                                Swal.showValidationMessage('CEP inválido. Informe 8 dígitos.');
                            }
                            return;
                        }
                        fetch('https://viacep.com.br/ws/' + cep + '/json/')
                            .then(r => r.json())
                            .then(j => {
                                if (j && j.erro) {
                                    if (window.Swal && Swal.showValidationMessage) {
                                        Swal.showValidationMessage('CEP não encontrado.');
                                    }
                                    return;
                                }
                                fillAddress(j || {});
                            })
                            .catch(() => {
                                if (window.Swal && Swal.showValidationMessage) {
                                    Swal.showValidationMessage('Falha ao consultar CEP.');
                                }
                            });
                    }
                    if (btnBuscar) btnBuscar.addEventListener('click', buscarCEP);
                    if (cepInput) {
                        cepInput.addEventListener('blur', function(){ if (cleanDigits(cepInput.value).length === 8) buscarCEP(); });
                    }
                },
                preConfirm: function () {
                    var container = Swal.getHtmlContainer();
                    var cpfCnpj = container.querySelector('input[name="cpfCnpj"]').value.trim();
                    var email = container.querySelector('input[name="email"]').value.trim();
                    var telefone = container.querySelector('input[name="telefone"]').value.trim();
                    if (cpfCnpj && !isValidCpfCnpj(cpfCnpj)) {
                        Swal.showValidationMessage('CPF/CNPJ inválido.');
                        return false;
                    }
                    if (email && !isValidEmail(email)) {
                        Swal.showValidationMessage('E-mail inválido.');
                        return false;
                    }
                    if (telefone && !isValidPhoneBR(telefone)) {
                        Swal.showValidationMessage('Telefone inválido. Use DDD + número.');
                        return false;
                    }
                    var cep = container.querySelector('input[name="cep"]') ? container.querySelector('input[name="cep"]').value.trim() : '';
                    var cepDigits = (cep || '').replace(/\D+/g,'');
                    if (cepDigits && cepDigits.length !== 8) {
                        Swal.showValidationMessage('CEP inválido. Informe 8 dígitos.');
                        return false;
                    }
                    return uiSubmitFromSwal(url, 'POST', '#cliente-form').then(function (resp) {
                        if (!resp || !resp.ok) {
                            Swal.showValidationMessage((resp && resp.message) ? resp.message : 'Não foi possível salvar.');
                            return false;
                        }
                        return resp;
                    });
                }
            }).then(function (r) {
                if (r.isConfirmed) {
                    uiToastSuccess(r.value && r.value.message ? r.value.message : 'Salvo.');
                    refreshClientesList();
                }
            });
        }

        function confirmDeleteClienteFromRow(button) {
            var d = button ? button.dataset : {};
            var id = d.id;
            var nome = d.nome || 'cliente';
            uiConfirmDelete({
                title: 'Excluir cliente',
                text: 'Excluir ' + nome + '?'
            }).then(function (confirmed) {
                if (!confirmed) {
                    return;
                }
                uiFetchForm('/clientes/' + id + '/delete', 'POST', {}).then(function (resp) {
                    if (resp && resp.ok) {
                        uiToastSuccess(resp.message || 'Cliente excluído.');
                        refreshClientesList();
                    } else {
                        uiToastError(resp && resp.message ? resp.message : 'Não foi possível excluir.');
                    }
                });
            });
        }
    </script>
    <script>
        (function () {
            function applyFormatInList(scope) {
                if (window.uiApplyCpfCnpjFormattingIn) {
                    window.uiApplyCpfCnpjFormattingIn(scope || document);
                }
                if (window.uiApplyPhoneFormattingIn) {
                    window.uiApplyPhoneFormattingIn(scope || document);
                }
            }
            document.addEventListener('DOMContentLoaded', function () {
                applyFormatInList(document);
            });
            document.body.addEventListener('htmx:afterSwap', function (evt) {
                var tgt = evt && evt.detail && evt.detail.target;
                if (tgt && tgt.id === 'client-list') {
                    applyFormatInList(tgt);
                }
            });
        })();
    </script>
    <script>
        function digitsOnly(s) {
            return (s || '').replace(/\D+/g, '');
        }
        function isValidCpfCnpj(v) {
            var s = digitsOnly(v);
            if (s.length === 11) return isValidCpf(s);
            if (s.length === 14) return isValidCnpj(s);
            return false;
        }
        function isValidEmail(email) {
            if (!email) return true;
            var e = email.trim().toLowerCase();
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);
        }
        function isValidPhoneBR(v) {
            var s = digitsOnly(v);
            return s.length === 10 || s.length === 11;
        }
        function isValidCpf(cpf) {
            if (/^(\d)\1+$/.test(cpf)) return false;
            var d1 = 0, d2 = 0, i, dig;
            for (i = 0; i < 9; i++) {
                dig = cpf.charCodeAt(i) - 48;
                d1 += dig * (10 - i);
                d2 += dig * (11 - i);
            }
            d1 = 11 - (d1 % 11);
            if (d1 >= 10) d1 = 0;
            d2 += d1 * 2;
            d2 = 11 - (d2 % 11);
            if (d2 >= 10) d2 = 0;
            return d1 === (cpf.charCodeAt(9) - 48) && d2 === (cpf.charCodeAt(10) - 48);
        }
        function isValidCnpj(cnpj) {
            if (/^(\d)\1+$/.test(cnpj)) return false;
            var w1 = [5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2];
            var w2 = [6, 5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2];
            var s1 = 0, s2 = 0, i;
            for (i = 0; i < 12; i++) s1 += (cnpj.charCodeAt(i) - 48) * w1[i];
            var r1 = s1 % 11, d1 = r1 < 2 ? 0 : 11 - r1;
            for (i = 0; i < 13; i++) s2 += (i < 12 ? (cnpj.charCodeAt(i) - 48) : d1) * w2[i];
            var r2 = s2 % 11, d2 = r2 < 2 ? 0 : 11 - r2;
            return d1 === (cnpj.charCodeAt(12) - 48) && d2 === (cnpj.charCodeAt(13) - 48);
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
</body>

</html>
