<!-- Checklist Item Fragment -->
<li th:fragment="item" th:object="${doc}"
    class="flex items-start gap-3 p-3 rounded-lg border transition-all duration-200"
    th:classappend="*{entregue} ? 'bg-green-50 border-green-200' : 'bg-white border-gray-200 hover:border-[var(--gold)]'">

    <div class="pt-1">
        <input type="checkbox" th:checked="*{entregue}" disabled
            class="w-5 h-5 text-[var(--navy-blue)] rounded border-gray-300 cursor-not-allowed">
    </div>

    <div class="flex-1">
        <span class="text-sm font-medium" th:classappend="*{entregue} ? 'text-green-700 line-through' : 'text-gray-800'"
            th:text="*{nome}">
            Nome do Documento
        </span>

        <!-- Mostrar arquivo anexado se existir -->
        <div th:if="*{documento != null}" class="mt-2">
            <a th:href="@{/processos/documento/{id}/download(id=*{documento.id})}"
                class="text-xs text-blue-600 hover:text-blue-800 flex items-center gap-1">
                <i class="fas fa-file-pdf"></i>
                <span th:text="*{documento.nomeOriginal}">arquivo.pdf</span>
                <span class="text-gray-500"
                    th:text="'(' + ${#numbers.formatDecimal(doc.documento.tamanho / 1024.0, 1, 1)} + ' KB)'">
                </span>
            </a>
        </div>
    </div>

    <!-- Botão de Upload (apenas se não tiver documento) -->
    <div th:if="${!doc.entregue}" class="flex-shrink-0">
        <form th:action="@{/processos/etapa/{eid}/checklist/{cid}/upload(eid=*{etapa.id}, cid=*{id})}" method="post"
            enctype="multipart/form-data" class="flex items-center gap-2"
            th:hx-post="@{/processos/etapa/{eid}/checklist/{cid}/upload(eid=*{etapa.id}, cid=*{id})}"
            hx-encoding="multipart/form-data" hx-target="closest li" hx-swap="outerHTML" style="display: inline-block;">

            <input type="file" name="arquivo" accept=".pdf,.jpg,.jpeg,.png,.docx,.xlsx" class="hidden"
                th:id="'file-' + *{id}"
                onchange="this.form.dispatchEvent(new Event('submit', {bubbles: true, cancelable: true}))">

            <label th:for="'file-' + *{id}" class="btn btn-sm btn-outline-primary cursor-pointer mb-0"
                style="font-size: 0.75rem; padding: 0.25rem 0.75rem;">
                <i class="fas fa-upload"></i> Anexar
            </label>
        </form>
    </div>

    <div th:if="*{entregue}" class="flex-shrink-0">
        <i class="fas fa-check-circle text-green-600 text-lg"></i>
    </div>
</li>

<!-- Error Fragment -->
<li th:fragment="error" class="flex items-center gap-2 p-3 rounded-lg border border-red-200 bg-red-50">
    <i class="fas fa-exclamation-circle text-red-600"></i>
    <span class="text-sm text-red-700" th:text="${error}">Erro ao enviar arquivo</span>
</li>